<style>
    /* Sidspecifika stilar för hemsidan */
    .loading-container {
        font-family: 'Courier New', monospace;
        color: #00FF00;
        text-align: center;
        /* Flyttar till toppen och tar bort centrering */
        padding-top: 20px; /* Lite padding från toppen */
        width: 100%;
        /* Tar bort flex-relaterade höjd/justeringar här för att den ska ligga högst upp */
        display: block; /* Sätt tillbaka till block för normalt flöde */
    }

    .loading-text {
        font-size: 2em;
        margin-bottom: 10px;
    }

    .progress-bar-container {
        width: 80%;
        max-width: 400px;
        height: 25px;
        border: 2px solid #00FF00;
        margin: 10px auto; /* Mindre marginal för att komma högre upp */
        box-sizing: border-box;
        overflow: hidden;
    }

    .progress-bar-fill {
        height: 100%;
        width: 0%;
        background-color: #00FF00;
        /* Animationen styrs nu via JavaScript */
        /* animation: fillProgress 2s linear infinite alternate; */ 
    }

    /* @keyframes fillProgress tas bort eftersom JS styr bredden */

    .percentage {
        font-size: 1.5em;
        margin-top: 5px; /* Mindre marginal */
    }

    .blinking-cursor {
        font-size: 1.5em;
        animation: blinkCursor 1s infinite;
    }

    @keyframes blinkCursor {
        0%, 100% { opacity: 1; }
        50% { opacity: 0; }
    }

    /* Justering för .content när home-sidan är aktiv */
    /* Återställer standardpadding och tar bort flex-justering för att Home ska flöda normalt */
    #content {
        padding: 20px; /* Återställer standardpadding */
        display: block; /* Återgår till block för normalt flöde */
        justify-content: flex-start; /* Tar bort vertikal centrering */
        align-items: flex-start; /* Tar bort horisontell centrering */
    }
</style>

<div class="loading-container">
    <div class="loading-text">Loading Lindvall...</div>
    <div class="progress-bar-container">
        <div class="progress-bar-fill" id="progressBarFill"></div>
    </div>
    <div class="percentage" id="loadingPercentage">0%</div>
    <div class="blinking-cursor">_</div>
</div>

<div class="prompt-block" style="margin-top: 40px;">Welcome to the retro terminal interface.</div>

<script>
    let homeAnimationId = null; // Specifik för den här sidans animation
    let animationStartTimestamp = null; // För att spåra animationens starttid

    function updatePercentage(timestamp) {
        const progressBarFill = document.getElementById('progressBarFill');
        const loadingPercentage = document.getElementById('loadingPercentage');

        if (!progressBarFill || !loadingPercentage) {
            // Om elementen inte finns längre (sidan har bytts), avbryt animationen
            stopHomeAnimation();
            return;
        }

        if (!animationStartTimestamp) animationStartTimestamp = timestamp;
        const elapsed = timestamp - animationStartTimestamp; // Tid sedan animationen startade

        const animationDuration = 2000; // 2 sekunder för en full cykel (fram och tillbaka)
        const halfDuration = animationDuration / 2; // 1 sekund för en riktning
        const currentCycleTime = elapsed % animationDuration; // Tid inom den aktuella cykeln

        let percentage;
        if (currentCycleTime < halfDuration) {
            // Första halvan av cykeln: 0% till 100%
            percentage = Math.floor((currentCycleTime / halfDuration) * 100);
        } else {
            // Andra halvan av cykeln: 100% till 0%
            percentage = Math.floor(((animationDuration - currentCycleTime) / halfDuration) * 100);
        }
        
        percentage = Math.max(0, Math.min(100, percentage)); // Se till att procenten är mellan 0 och 100

        progressBarFill.style.width = `${percentage}%`; // Uppdatera bredden
        loadingPercentage.textContent = `${percentage}%`;

        homeAnimationId = requestAnimationFrame(updatePercentage);
    }

    // Funktion för att starta animationen
    window.startHomeAnimation = function() {
        if (!homeAnimationId) { // Starta bara om den inte redan körs
            animationStartTimestamp = null; // Återställ starttiden vid varje start
            homeAnimationId = requestAnimationFrame(updatePercentage);
            console.log('Home page animation started.');
        }
    };

    // Funktion för att stoppa animationen
    window.stopHomeAnimation = function() {
        if (homeAnimationId) {
            cancelAnimationFrame(homeAnimationId);
            homeAnimationId = null;
            animationStartTimestamp = null; // Återställ också starttiden
            console.log('Home page animation stopped.');
        }
    };

    // Anpassa .content-stilen när denna sida laddas
    document.addEventListener('DOMContentLoaded', () => {
        const contentDiv = document.getElementById('content');
        if (contentDiv) {
            contentDiv.style.padding = '20px';
            contentDiv.style.display = 'block';
            contentDiv.style.justifyContent = 'flex-start';
            contentDiv.style.alignItems = 'flex-start';
        }
        // Animationen startas nu av index.html's showContent funktion
        // när home-sidan laddas in första gången eller navigeras till.
    });

</script>